<?xml version="1.0" encoding="UTF-8"?>
<project name="install" default="install-component" basedir="." description="Clone repo and run composer">
    <target name="install-component">
        <phingcall target="git-clone">
            <property name="component" value="${component}"/>
        </phingcall>
        <phingcall target="composer">
            <property name="component" value="${component}"/>
        </phingcall>
    </target>
    <target name="git-clone">
        <property file="phing/config/app.properties" />
        <echo msg="Cloning ${${component}.repo}" />
        <gitclone repository="${${component}.repo}" targetPath="${${component}.dir}" />
        <chmod file="${${component}.dir}/app/storage" mode="0777" />
    </target>
    <target name="composer">
        <property file="phing/config/app.properties" />
        <echo msg="Installing ${component} via Composer" />
        <exec passthru="true" checkreturn="true" command="composer -v install" dir="${${component}.dir}" />
        <echo msg="Install finished!" />
    </target>
</project>
